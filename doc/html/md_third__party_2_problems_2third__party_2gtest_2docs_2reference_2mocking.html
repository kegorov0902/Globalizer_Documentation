<!DOCTYPE html>

<html lang="ru" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Globalizer: Mocking Reference &#8212; документация Globalizer 141025</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=799f848e"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=cd1d70c9"></script>
    <link rel="index" title="Алфавитный указатель" href="../genindex.html" />
    <link rel="search" title="Поиск" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="mocking-reference">
<h1>Mocking Reference<a class="headerlink" href="#mocking-reference" title="Ссылка на этот заголовок">¶</a></h1>
<div class="doxygen-content docutils container">
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Globalizer: Mocking Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Globalizer<span id="projectnumber">&#160;1.1</span>
   </div>
   <div id="projectbrief">Exascale Minimizer - параллельная программная система для решения задач глобальной оптимизации</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Создано системой Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Поиск',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Загрузка...</div>
<div class="SRStatus" id="Searching">Поиск...</div>
<div class="SRStatus" id="NoMatches">Не найдено</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Mocking Reference </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md694"></a></p>
<p>This page lists the facilities provided by GoogleTest for creating and working with mock objects. To use them, add <span class="tt">#include &lt;gmock/gmock.h&gt;</span>.</p>
<h1 class="doxsection"><a class="anchor" id="macros"></a>
Macros</h1>
<p>GoogleTest defines the following macros for working with mocks.</p>
<h2 class="doxsection"><a class="anchor" id="MOCK_METHOD"></a>
MOCK_METHOD</h2>
<p><span class="tt">MOCK_METHOD(</span>*<span class="tt">return_type</span>*<span class="tt">,</span>*<span class="tt">method_name</span>*<span class="tt">, (</span>*<span class="tt">args...</span>*<span class="tt">));</span> \ <span class="tt">MOCK_METHOD(</span>*<span class="tt">return_type</span>*<span class="tt">,</span>*<span class="tt">method_name</span>*<span class="tt">, (</span>*<span class="tt">args...</span>*<span class="tt">),
(</span>*<span class="tt">specs...</span>*<span class="tt">));</span></p>
<p>Defines a mock method <em><span class="tt">method_name</span></em> with arguments <span class="tt">(</span>*<span class="tt">args...</span>*<span class="tt">)</span> and return type <em><span class="tt">return_type</span></em> within a mock class.</p>
<p>The parameters of <span class="tt">MOCK_METHOD</span> mirror the method declaration. The optional fourth parameter <em><span class="tt">specs...</span></em> is a comma-separated list of qualifiers. The following qualifiers are accepted:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Qualifier  </th><th class="markdownTableHeadNone">Meaning  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">const</span>  </td><td class="markdownTableBodyNone">Makes the mocked method a <span class="tt">const</span> method. Required if overriding a <span class="tt">const</span> method.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">override</span>  </td><td class="markdownTableBodyNone">Marks the method with <span class="tt">override</span>. Recommended if overriding a <span class="tt">virtual</span> method.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">noexcept</span>  </td><td class="markdownTableBodyNone">Marks the method with <span class="tt">noexcept</span>. Required if overriding a <span class="tt">noexcept</span> method.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Calltype(</span>*<span class="tt">calltype</span>*<span class="tt">)</span>  </td><td class="markdownTableBodyNone">Sets the call type for the method, for example <span class="tt">Calltype(STDMETHODCALLTYPE)</span>. Useful on Windows.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">ref(</span>*<span class="tt">qualifier</span>*<span class="tt">)</span>  </td><td class="markdownTableBodyNone">Marks the method with the given reference qualifier, for example <span class="tt">ref(&amp;)</span> or <span class="tt">ref(&amp;&amp;)</span>. Required if overriding a method that has a reference qualifier.  </td></tr>
</table>
<p>Note that commas in arguments prevent <span class="tt">MOCK_METHOD</span> from parsing the arguments correctly if they are not appropriately surrounded by parentheses. See the following example:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MyMock {</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  <span class="comment">// The following 2 lines will not compile due to commas in the arguments:</span></div>
<div class="line">  MOCK_METHOD(std::pair&lt;bool, int&gt;, GetPair, ());              <span class="comment">// Error!</span></div>
<div class="line">  MOCK_METHOD(<span class="keywordtype">bool</span>, CheckMap, (std::map&lt;int, double&gt;, <span class="keywordtype">bool</span>));  <span class="comment">// Error!</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// One solution - wrap arguments that contain commas in parentheses:</span></div>
<div class="line">  MOCK_METHOD((std::pair&lt;bool, int&gt;), GetPair, ());</div>
<div class="line">  MOCK_METHOD(<span class="keywordtype">bool</span>, CheckMap, ((std::map&lt;int, double&gt;), <span class="keywordtype">bool</span>));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Another solution - use type aliases:</span></div>
<div class="line">  <span class="keyword">using </span>BoolAndInt = std::pair&lt;bool, int&gt;;</div>
<div class="line">  MOCK_METHOD(BoolAndInt, GetPair, ());</div>
<div class="line">  <span class="keyword">using </span>MapIntDouble = std::map&lt;int, double&gt;;</div>
<div class="line">  MOCK_METHOD(<span class="keywordtype">bool</span>, CheckMap, (MapIntDouble, <span class="keywordtype">bool</span>));</div>
<div class="line">};</div>
</div><!-- fragment --><p><span class="tt">MOCK_METHOD</span> must be used in the <span class="tt">public:</span> section of a mock class definition, regardless of whether the method being mocked is <span class="tt">public</span>, <span class="tt">protected</span>, or <span class="tt">private</span> in the base class.</p>
<h2 class="doxsection"><a class="anchor" id="EXPECT_CALL"></a>
EXPECT_CALL</h2>
<p><span class="tt">EXPECT_CALL(</span>*<span class="tt">mock_object</span>*<span class="tt">,</span>*<span class="tt">method_name</span>*<span class="tt">(</span>*<span class="tt">matchers...</span>*<span class="tt">))</span></p>
<p>Creates an <a href="../gmock_for_dummies.md#setting-expectations">expectation</a> that the method <em><span class="tt">method_name</span></em> of the object <em><span class="tt">mock_object</span></em> is called with arguments that match the given matchers <em><span class="tt">matchers...</span></em>. <span class="tt">EXPECT_CALL</span> must precede any code that exercises the mock object.</p>
<p>The parameter <em><span class="tt">matchers...</span></em> is a comma-separated list of <a href="../gmock_for_dummies.md#matchers-what-arguments-do-we-expect">matchers</a> that correspond to each argument of the method <em><span class="tt">method_name</span></em>. The expectation will apply only to calls of <em><span class="tt">method_name</span></em> whose arguments match all of the matchers. If <span class="tt">(</span>*<span class="tt">matchers...</span>*<span class="tt">)</span> is omitted, the expectation behaves as if each argument's matcher were a <a href="matchers.md#wildcard">wildcard matcher (<span class="tt">_</span>)</a>. See the <a class="el" href="md_third__party_2_problems_2third__party_2gtest_2docs_2reference_2matchers.html">Matchers Reference</a> for a list of all built-in matchers.</p>
<p>The following chainable clauses can be used to modify the expectation, and they must be used in the following order:</p>
<div class="fragment"><div class="line">EXPECT_CALL(mock_object, method_name(matchers...))</div>
<div class="line">    .With(multi_argument_matcher)  <span class="comment">// Can be used at most once</span></div>
<div class="line">    .Times(cardinality)            <span class="comment">// Can be used at most once</span></div>
<div class="line">    .InSequence(sequences...)      <span class="comment">// Can be used any number of times</span></div>
<div class="line">    .After(expectations...)        <span class="comment">// Can be used any number of times</span></div>
<div class="line">    .WillOnce(action)              <span class="comment">// Can be used any number of times</span></div>
<div class="line">    .WillRepeatedly(action)        <span class="comment">// Can be used at most once</span></div>
<div class="line">    .RetiresOnSaturation();        <span class="comment">// Can be used at most once</span></div>
</div><!-- fragment --><p>See details for each modifier clause below.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md695"></a>
With {#EXPECT_CALL.With}</h3>
<p><span class="tt">.With(</span>*<span class="tt">multi_argument_matcher</span>*<span class="tt">)</span></p>
<p>Restricts the expectation to apply only to mock function calls whose arguments as a whole match the multi-argument matcher <em><span class="tt">multi_argument_matcher</span></em>.</p>
<p>GoogleTest passes all of the arguments as one tuple into the matcher. The parameter <em><span class="tt">multi_argument_matcher</span></em> must thus be a matcher of type <span class="tt"><a class="el" href="class_matcher.html">Matcher</a>&lt;std::tuple&lt;A1, ..., An&gt;&gt;</span>, where <span class="tt">A1, ..., An</span> are the types of the function arguments.</p>
<p>For example, the following code sets the expectation that <span class="tt">my_mock.SetPosition()</span> is called with any two arguments, the first argument being less than the second:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>::testing::_;</div>
<div class="line"><span class="keyword">using </span>::testing::Lt;</div>
<div class="line">...</div>
<div class="line">EXPECT_CALL(my_mock, SetPosition(_, _))</div>
<div class="line">    .With(Lt());</div>
</div><!-- fragment --><p>GoogleTest provides some built-in matchers for 2-tuples, including the <span class="tt">Lt()</span> matcher above. See <a href="matchers.md#MultiArgMatchers">Multi-argument Matchers</a>.</p>
<p>The <span class="tt">With</span> clause can be used at most once on an expectation and must be the first clause.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md696"></a>
Times {#EXPECT_CALL.Times}</h3>
<p><span class="tt">.Times(</span>*<span class="tt">cardinality</span>*<span class="tt">)</span></p>
<p>Specifies how many times the mock function call is expected.</p>
<p>The parameter <em><span class="tt">cardinality</span></em> represents the number of expected calls and can be one of the following, all defined in the <span class="tt">::testing</span> namespace:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Cardinality  </th><th class="markdownTableHeadNone">Meaning  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">AnyNumber()</span>  </td><td class="markdownTableBodyNone">The function can be called any number of times.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">AtLeast(n)</span>  </td><td class="markdownTableBodyNone">The function call is expected at least <em>n</em> times.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">AtMost(n)</span>  </td><td class="markdownTableBodyNone">The function call is expected at most <em>n</em> times.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Between(m, n)</span>  </td><td class="markdownTableBodyNone">The function call is expected between <em>m</em> and <em>n</em> times, inclusive.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Exactly(n)</span> or <span class="tt">n</span>  </td><td class="markdownTableBodyNone">The function call is expected exactly <em>n</em> times. If <em>n</em> is 0, the call should never happen.  </td></tr>
</table>
<p>If the <span class="tt">Times</span> clause is omitted, GoogleTest infers the cardinality as follows:</p>
<ul>
<li>If neither `WillOnce` nor `WillRepeatedly` are specified, the inferred cardinality is <span class="tt">Times(1)</span>.</li>
<li>If there are <em>n</em> <span class="tt">WillOnce</span> clauses and no <span class="tt">WillRepeatedly</span> clause, where <em>n</em> &gt;= 1, the inferred cardinality is <span class="tt">Times(n)</span>.</li>
<li>If there are <em>n</em> <span class="tt">WillOnce</span> clauses and one <span class="tt">WillRepeatedly</span> clause, where <em>n</em> &gt;= 0, the inferred cardinality is <span class="tt">Times(AtLeast(n))</span>.</li>
</ul>
<p>The <span class="tt">Times</span> clause can be used at most once on an expectation.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md697"></a>
InSequence {#EXPECT_CALL.InSequence}</h3>
<p><span class="tt">.InSequence(</span>*<span class="tt">sequences...</span>*<span class="tt">)</span></p>
<p>Specifies that the mock function call is expected in a certain sequence.</p>
<p>The parameter <em><span class="tt">sequences...</span></em> is any number of <a class="el" href="#Sequence">`Sequence`</a> objects. Expected calls assigned to the same sequence are expected to occur in the order the expectations are declared.</p>
<p>For example, the following code sets the expectation that the <span class="tt">Reset()</span> method of <span class="tt">my_mock</span> is called before both <span class="tt">GetSize()</span> and <span class="tt">Describe()</span>, and <span class="tt">GetSize()</span> and <span class="tt">Describe()</span> can occur in any order relative to each other:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>::testing::Sequence;</div>
<div class="line">Sequence s1, s2;</div>
<div class="line">...</div>
<div class="line">EXPECT_CALL(my_mock, Reset())</div>
<div class="line">    .InSequence(s1, s2);</div>
<div class="line">EXPECT_CALL(my_mock, GetSize())</div>
<div class="line">    .InSequence(s1);</div>
<div class="line">EXPECT_CALL(my_mock, Describe())</div>
<div class="line">    .InSequence(s2);</div>
</div><!-- fragment --><p>The <span class="tt">InSequence</span> clause can be used any number of times on an expectation.</p>
<p>See also the <a class="el" href="#InSequence">`InSequence` class</a>.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md698"></a>
After {#EXPECT_CALL.After}</h3>
<p><span class="tt">.After(</span>*<span class="tt">expectations...</span>*<span class="tt">)</span></p>
<p>Specifies that the mock function call is expected to occur after one or more other calls.</p>
<p>The parameter <em><span class="tt">expectations...</span></em> can be up to five <a class="el" href="#Expectation">`Expectation`</a> or <a class="el" href="#ExpectationSet">`ExpectationSet`</a> objects. The mock function call is expected to occur after all of the given expectations.</p>
<p>For example, the following code sets the expectation that the <span class="tt">Describe()</span> method of <span class="tt">my_mock</span> is called only after both <span class="tt">InitX()</span> and <span class="tt">InitY()</span> have been called.</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>::testing::Expectation;</div>
<div class="line">...</div>
<div class="line">Expectation init_x = EXPECT_CALL(my_mock, InitX());</div>
<div class="line">Expectation init_y = EXPECT_CALL(my_mock, InitY());</div>
<div class="line">EXPECT_CALL(my_mock, Describe())</div>
<div class="line">    .After(init_x, init_y);</div>
</div><!-- fragment --><p>The <span class="tt">ExpectationSet</span> object is helpful when the number of prerequisites for an expectation is large or variable, for example:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>::testing::ExpectationSet;</div>
<div class="line">...</div>
<div class="line">ExpectationSet all_inits;</div>
<div class="line"><span class="comment">// Collect all expectations of InitElement() calls</span></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; element_count; i++) {</div>
<div class="line">  all_inits += EXPECT_CALL(my_mock, InitElement(i));</div>
<div class="line">}</div>
<div class="line">EXPECT_CALL(my_mock, Describe())</div>
<div class="line">    .After(all_inits);  <span class="comment">// Expect Describe() call after all InitElement() calls</span></div>
</div><!-- fragment --><p>The <span class="tt">After</span> clause can be used any number of times on an expectation.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md699"></a>
WillOnce {#EXPECT_CALL.WillOnce}</h3>
<p><span class="tt">.WillOnce(</span>*<span class="tt">action</span>*<span class="tt">)</span></p>
<p>Specifies the mock function's actual behavior when invoked, for a single matching function call.</p>
<p>The parameter <em><span class="tt">action</span></em> represents the <a href="../gmock_for_dummies.md#actions-what-should-it-do">action</a> that the function call will perform. See the <a class="el" href="md_third__party_2_problems_2third__party_2gtest_2docs_2reference_2actions.html">Actions Reference</a> for a list of built-in actions.</p>
<p>The use of <span class="tt">WillOnce</span> implicitly sets a cardinality on the expectation when <span class="tt">Times</span> is not specified. See `Times`.</p>
<p>Each matching function call will perform the next action in the order declared. For example, the following code specifies that <span class="tt">my_mock.GetNumber()</span> is expected to be called exactly 3 times and will return <span class="tt">1</span>, <span class="tt">2</span>, and <span class="tt">3</span> respectively on the first, second, and third calls:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>::testing::Return;</div>
<div class="line">...</div>
<div class="line">EXPECT_CALL(my_mock, GetNumber())</div>
<div class="line">    .WillOnce(Return(1))</div>
<div class="line">    .WillOnce(Return(2))</div>
<div class="line">    .WillOnce(Return(3));</div>
</div><!-- fragment --><p>The <span class="tt">WillOnce</span> clause can be used any number of times on an expectation. Unlike <span class="tt">WillRepeatedly</span>, the action fed to each <span class="tt">WillOnce</span> call will be called at most once, so may be a move-only type and/or have an <span class="tt">&amp;&amp;</span>-qualified call operator.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md700"></a>
WillRepeatedly {#EXPECT_CALL.WillRepeatedly}</h3>
<p><span class="tt">.WillRepeatedly(</span>*<span class="tt">action</span>*<span class="tt">)</span></p>
<p>Specifies the mock function's actual behavior when invoked, for all subsequent matching function calls. Takes effect after the actions specified in the `WillOnce` clauses, if any, have been performed.</p>
<p>The parameter <em><span class="tt">action</span></em> represents the <a href="../gmock_for_dummies.md#actions-what-should-it-do">action</a> that the function call will perform. See the <a class="el" href="md_third__party_2_problems_2third__party_2gtest_2docs_2reference_2actions.html">Actions Reference</a> for a list of built-in actions.</p>
<p>The use of <span class="tt">WillRepeatedly</span> implicitly sets a cardinality on the expectation when <span class="tt">Times</span> is not specified. See `Times`.</p>
<p>If any <span class="tt">WillOnce</span> clauses have been specified, matching function calls will perform those actions before the action specified by <span class="tt">WillRepeatedly</span>. See the following example:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>::testing::Return;</div>
<div class="line">...</div>
<div class="line">EXPECT_CALL(my_mock, GetName())</div>
<div class="line">    .WillRepeatedly(Return(<span class="stringliteral">&quot;John Doe&quot;</span>));  <span class="comment">// Return &quot;John Doe&quot; on all calls</span></div>
<div class="line"> </div>
<div class="line">EXPECT_CALL(my_mock, GetNumber())</div>
<div class="line">    .WillOnce(Return(42))        <span class="comment">// Return 42 on the first call</span></div>
<div class="line">    .WillRepeatedly(Return(7));  <span class="comment">// Return 7 on all subsequent calls</span></div>
</div><!-- fragment --><p>The <span class="tt">WillRepeatedly</span> clause can be used at most once on an expectation.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md701"></a>
RetiresOnSaturation {#EXPECT_CALL.RetiresOnSaturation}</h3>
<p><span class="tt">.RetiresOnSaturation()</span></p>
<p>Indicates that the expectation will no longer be active after the expected number of matching function calls has been reached.</p>
<p>The <span class="tt">RetiresOnSaturation</span> clause is only meaningful for expectations with an upper-bounded cardinality. The expectation will <em>retire</em> (no longer match any function calls) after it has been <em>saturated</em> (the upper bound has been reached). See the following example:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>::testing::_;</div>
<div class="line"><span class="keyword">using </span>::testing::AnyNumber;</div>
<div class="line">...</div>
<div class="line">EXPECT_CALL(my_mock, SetNumber(_))  <span class="comment">// Expectation 1</span></div>
<div class="line">    .Times(AnyNumber());</div>
<div class="line">EXPECT_CALL(my_mock, SetNumber(7))  <span class="comment">// Expectation 2</span></div>
<div class="line">    .Times(2)</div>
<div class="line">    .RetiresOnSaturation();</div>
</div><!-- fragment --><p>In the above example, the first two calls to <span class="tt">my_mock.SetNumber(7)</span> match expectation 2, which then becomes inactive and no longer matches any calls. A third call to <span class="tt">my_mock.SetNumber(7)</span> would then match expectation 1. Without <span class="tt">RetiresOnSaturation()</span> on expectation 2, a third call to <span class="tt">my_mock.SetNumber(7)</span> would match expectation 2 again, producing a failure since the limit of 2 calls was exceeded.</p>
<p>The <span class="tt">RetiresOnSaturation</span> clause can be used at most once on an expectation and must be the last clause.</p>
<h2 class="doxsection"><a class="anchor" id="ON_CALL"></a>
ON_CALL</h2>
<p><span class="tt">ON_CALL(</span>*<span class="tt">mock_object</span>*<span class="tt">,</span>*<span class="tt">method_name</span>*<span class="tt">(</span>*<span class="tt">matchers...</span>*<span class="tt">))</span></p>
<p>Defines what happens when the method <em><span class="tt">method_name</span></em> of the object <em><span class="tt">mock_object</span></em> is called with arguments that match the given matchers <em><span class="tt">matchers...</span></em>. Requires a modifier clause to specify the method's behavior. <em>Does not</em> set any expectations that the method will be called.</p>
<p>The parameter <em><span class="tt">matchers...</span></em> is a comma-separated list of <a href="../gmock_for_dummies.md#matchers-what-arguments-do-we-expect">matchers</a> that correspond to each argument of the method <em><span class="tt">method_name</span></em>. The <span class="tt">ON_CALL</span> specification will apply only to calls of <em><span class="tt">method_name</span></em> whose arguments match all of the matchers. If <span class="tt">(</span>*<span class="tt">matchers...</span>*<span class="tt">)</span> is omitted, the behavior is as if each argument's matcher were a <a href="matchers.md#wildcard">wildcard matcher (<span class="tt">_</span>)</a>. See the <a class="el" href="md_third__party_2_problems_2third__party_2gtest_2docs_2reference_2matchers.html">Matchers Reference</a> for a list of all built-in matchers.</p>
<p>The following chainable clauses can be used to set the method's behavior, and they must be used in the following order:</p>
<div class="fragment"><div class="line">ON_CALL(mock_object, method_name(matchers...))</div>
<div class="line">    .With(multi_argument_matcher)  <span class="comment">// Can be used at most once</span></div>
<div class="line">    .WillByDefault(action);        <span class="comment">// Required</span></div>
</div><!-- fragment --><p>See details for each modifier clause below.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md702"></a>
With {#ON_CALL.With}</h3>
<p><span class="tt">.With(</span>*<span class="tt">multi_argument_matcher</span>*<span class="tt">)</span></p>
<p>Restricts the specification to only mock function calls whose arguments as a whole match the multi-argument matcher <em><span class="tt">multi_argument_matcher</span></em>.</p>
<p>GoogleTest passes all of the arguments as one tuple into the matcher. The parameter <em><span class="tt">multi_argument_matcher</span></em> must thus be a matcher of type <span class="tt"><a class="el" href="class_matcher.html">Matcher</a>&lt;std::tuple&lt;A1, ..., An&gt;&gt;</span>, where <span class="tt">A1, ..., An</span> are the types of the function arguments.</p>
<p>For example, the following code sets the default behavior when <span class="tt">my_mock.SetPosition()</span> is called with any two arguments, the first argument being less than the second:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>::testing::_;</div>
<div class="line"><span class="keyword">using </span>::testing::Lt;</div>
<div class="line"><span class="keyword">using </span>::testing::Return;</div>
<div class="line">...</div>
<div class="line">ON_CALL(my_mock, SetPosition(_, _))</div>
<div class="line">    .With(Lt())</div>
<div class="line">    .WillByDefault(Return(<span class="keyword">true</span>));</div>
</div><!-- fragment --><p>GoogleTest provides some built-in matchers for 2-tuples, including the <span class="tt">Lt()</span> matcher above. See <a href="matchers.md#MultiArgMatchers">Multi-argument Matchers</a>.</p>
<p>The <span class="tt">With</span> clause can be used at most once with each <span class="tt">ON_CALL</span> statement.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md703"></a>
WillByDefault {#ON_CALL.WillByDefault}</h3>
<p><span class="tt">.WillByDefault(</span>*<span class="tt">action</span>*<span class="tt">)</span></p>
<p>Specifies the default behavior of a matching mock function call.</p>
<p>The parameter <em><span class="tt">action</span></em> represents the <a href="../gmock_for_dummies.md#actions-what-should-it-do">action</a> that the function call will perform. See the <a class="el" href="md_third__party_2_problems_2third__party_2gtest_2docs_2reference_2actions.html">Actions Reference</a> for a list of built-in actions.</p>
<p>For example, the following code specifies that by default, a call to <span class="tt">my_mock.Greet()</span> will return <span class="tt">"hello"</span>:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>::testing::Return;</div>
<div class="line">...</div>
<div class="line">ON_CALL(my_mock, Greet())</div>
<div class="line">    .WillByDefault(Return(<span class="stringliteral">&quot;hello&quot;</span>));</div>
</div><!-- fragment --><p>The action specified by <span class="tt">WillByDefault</span> is superseded by the actions specified on a matching <span class="tt">EXPECT_CALL</span> statement, if any. See the `WillOnce` and `WillRepeatedly` clauses of <span class="tt">EXPECT_CALL</span>.</p>
<p>The <span class="tt">WillByDefault</span> clause must be used exactly once with each <span class="tt">ON_CALL</span> statement.</p>
<h1 class="doxsection"><a class="anchor" id="classes"></a>
Classes</h1>
<p>GoogleTest defines the following classes for working with mocks.</p>
<h2 class="doxsection"><a class="anchor" id="DefaultValue"></a>
Setting the Default Value for a Return Type</h2>
<p><span class="tt"><a class="el" href="classtesting_1_1_default_value.html">testing::DefaultValue</a>&lt;T&gt;</span></p>
<p>Allows a user to specify the default value for a type <span class="tt">T</span> that is both copyable and publicly destructible (i.e. anything that can be used as a function return type). For mock functions with a return type of <span class="tt">T</span>, this default value is returned from function calls that do not specify an action.</p>
<p>Provides the static methods <span class="tt">Set()</span>, <span class="tt">SetFactory()</span>, and <span class="tt">Clear()</span> to manage the default value:</p>
<div class="fragment"><div class="line"><span class="comment">// Sets the default value to be returned. T must be copy constructible.</span></div>
<div class="line">DefaultValue&lt;T&gt;::Set(value);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Sets a factory. Will be invoked on demand. T must be move constructible.</span></div>
<div class="line">T MakeT();</div>
<div class="line">DefaultValue&lt;T&gt;::SetFactory(&amp;MakeT);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Unsets the default value.</span></div>
<div class="line">DefaultValue&lt;T&gt;::Clear();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="NiceMock"></a>
NiceMock</h2>
<p><span class="tt"><a class="el" href="classtesting_1_1_nice_mock.html">testing::NiceMock</a>&lt;T&gt;</span></p>
<p>Represents a mock object that suppresses warnings on <a href="../gmock_cook_book.md#uninteresting-vs-unexpected">uninteresting calls</a>. The template parameter <span class="tt">T</span> is any mock class, except for another <span class="tt">NiceMock</span>, <span class="tt"><a class="el" href="class_naggy_mock.html">NaggyMock</a></span>, or <span class="tt">StrictMock</span>.</p>
<p>Usage of <span class="tt">NiceMock&lt;T&gt;</span> is analogous to usage of <span class="tt">T</span>. <span class="tt">NiceMock&lt;T&gt;</span> is a subclass of <span class="tt">T</span>, so it can be used wherever an object of type <span class="tt">T</span> is accepted. In addition, <span class="tt">NiceMock&lt;T&gt;</span> can be constructed with any arguments that a constructor of <span class="tt">T</span> accepts.</p>
<p>For example, the following code suppresses warnings on the mock <span class="tt">my_mock</span> of type <span class="tt">MockClass</span> if a method other than <span class="tt">DoSomething()</span> is called:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>::<a class="code hl_class" href="classtesting_1_1_nice_mock.html">testing::NiceMock</a>;</div>
<div class="line">...</div>
<div class="line">NiceMock&lt;MockClass&gt; my_mock(<span class="stringliteral">&quot;some&quot;</span>, <span class="stringliteral">&quot;args&quot;</span>);</div>
<div class="line">EXPECT_CALL(my_mock, DoSomething());</div>
<div class="line">... code that uses my_mock ...</div>
<div class="ttc" id="aclasstesting_1_1_nice_mock_html"><div class="ttname"><a href="classtesting_1_1_nice_mock.html">testing::NiceMock</a></div><div class="ttdef"><b>Определения</b> gmock-nice-strict.h:151</div></div>
</div><!-- fragment --><p><span class="tt">NiceMock&lt;T&gt;</span> only works for mock methods defined using the <span class="tt">MOCK_METHOD</span> macro directly in the definition of class <span class="tt">T</span>. If a mock method is defined in a base class of <span class="tt">T</span>, a warning might still be generated.</p>
<p><span class="tt">NiceMock&lt;T&gt;</span> might not work correctly if the destructor of <span class="tt">T</span> is not virtual.</p>
<h2 class="doxsection"><a class="anchor" id="NaggyMock"></a>
NaggyMock</h2>
<p><span class="tt"><a class="el" href="classtesting_1_1_naggy_mock.html">testing::NaggyMock</a>&lt;T&gt;</span></p>
<p>Represents a mock object that generates warnings on <a href="../gmock_cook_book.md#uninteresting-vs-unexpected">uninteresting calls</a>. The template parameter <span class="tt">T</span> is any mock class, except for another <span class="tt">NiceMock</span>, <span class="tt"><a class="el" href="class_naggy_mock.html">NaggyMock</a></span>, or <span class="tt">StrictMock</span>.</p>
<p>Usage of <span class="tt"><a class="el" href="class_naggy_mock.html">NaggyMock</a>&lt;T&gt;</span> is analogous to usage of <span class="tt">T</span>. <span class="tt"><a class="el" href="class_naggy_mock.html">NaggyMock</a>&lt;T&gt;</span> is a subclass of <span class="tt">T</span>, so it can be used wherever an object of type <span class="tt">T</span> is accepted. In addition, <span class="tt"><a class="el" href="class_naggy_mock.html">NaggyMock</a>&lt;T&gt;</span> can be constructed with any arguments that a constructor of <span class="tt">T</span> accepts.</p>
<p>For example, the following code generates warnings on the mock <span class="tt">my_mock</span> of type <span class="tt">MockClass</span> if a method other than <span class="tt">DoSomething()</span> is called:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>::<a class="code hl_class" href="classtesting_1_1_naggy_mock.html">testing::NaggyMock</a>;</div>
<div class="line">...</div>
<div class="line">NaggyMock&lt;MockClass&gt; my_mock(<span class="stringliteral">&quot;some&quot;</span>, <span class="stringliteral">&quot;args&quot;</span>);</div>
<div class="line">EXPECT_CALL(my_mock, DoSomething());</div>
<div class="line">... code that uses my_mock ...</div>
<div class="ttc" id="aclasstesting_1_1_naggy_mock_html"><div class="ttname"><a href="classtesting_1_1_naggy_mock.html">testing::NaggyMock</a></div><div class="ttdef"><b>Определения</b> gmock-nice-strict.h:192</div></div>
</div><!-- fragment --><p><a class="el" href="class_mock.html">Mock</a> objects of type <span class="tt">T</span> by default behave the same way as <span class="tt"><a class="el" href="class_naggy_mock.html">NaggyMock</a>&lt;T&gt;</span>.</p>
<h2 class="doxsection"><a class="anchor" id="StrictMock"></a>
StrictMock</h2>
<p><span class="tt"><a class="el" href="classtesting_1_1_strict_mock.html">testing::StrictMock</a>&lt;T&gt;</span></p>
<p>Represents a mock object that generates test failures on <a href="../gmock_cook_book.md#uninteresting-vs-unexpected">uninteresting calls</a>. The template parameter <span class="tt">T</span> is any mock class, except for another <span class="tt">NiceMock</span>, <span class="tt"><a class="el" href="class_naggy_mock.html">NaggyMock</a></span>, or <span class="tt">StrictMock</span>.</p>
<p>Usage of <span class="tt">StrictMock&lt;T&gt;</span> is analogous to usage of <span class="tt">T</span>. <span class="tt">StrictMock&lt;T&gt;</span> is a subclass of <span class="tt">T</span>, so it can be used wherever an object of type <span class="tt">T</span> is accepted. In addition, <span class="tt">StrictMock&lt;T&gt;</span> can be constructed with any arguments that a constructor of <span class="tt">T</span> accepts.</p>
<p>For example, the following code generates a test failure on the mock <span class="tt">my_mock</span> of type <span class="tt">MockClass</span> if a method other than <span class="tt">DoSomething()</span> is called:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>::<a class="code hl_class" href="classtesting_1_1_strict_mock.html">testing::StrictMock</a>;</div>
<div class="line">...</div>
<div class="line">StrictMock&lt;MockClass&gt; my_mock(<span class="stringliteral">&quot;some&quot;</span>, <span class="stringliteral">&quot;args&quot;</span>);</div>
<div class="line">EXPECT_CALL(my_mock, DoSomething());</div>
<div class="line">... code that uses my_mock ...</div>
<div class="ttc" id="aclasstesting_1_1_strict_mock_html"><div class="ttname"><a href="classtesting_1_1_strict_mock.html">testing::StrictMock</a></div><div class="ttdef"><b>Определения</b> gmock-nice-strict.h:234</div></div>
</div><!-- fragment --><p><span class="tt">StrictMock&lt;T&gt;</span> only works for mock methods defined using the <span class="tt">MOCK_METHOD</span> macro directly in the definition of class <span class="tt">T</span>. If a mock method is defined in a base class of <span class="tt">T</span>, a failure might not be generated.</p>
<p><span class="tt">StrictMock&lt;T&gt;</span> might not work correctly if the destructor of <span class="tt">T</span> is not virtual.</p>
<h2 class="doxsection"><a class="anchor" id="Sequence"></a>
Sequence</h2>
<p><span class="tt">::testing::Sequence</span></p>
<p>Represents a chronological sequence of expectations. See the `InSequence` clause of <span class="tt">EXPECT_CALL</span> for usage.</p>
<h2 class="doxsection"><a class="anchor" id="InSequence"></a>
InSequence</h2>
<p><span class="tt">::testing::InSequence</span></p>
<p>An object of this type causes all expectations encountered in its scope to be put in an anonymous sequence.</p>
<p>This allows more convenient expression of multiple expectations in a single sequence:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>::testing::InSequence;</div>
<div class="line">{</div>
<div class="line">  InSequence seq;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// The following are expected to occur in the order declared.</span></div>
<div class="line">  EXPECT_CALL(...);</div>
<div class="line">  EXPECT_CALL(...);</div>
<div class="line">  ...</div>
<div class="line">  EXPECT_CALL(...);</div>
<div class="line">}</div>
</div><!-- fragment --><p>The name of the <span class="tt">InSequence</span> object does not matter.</p>
<h2 class="doxsection"><a class="anchor" id="Expectation"></a>
Expectation</h2>
<p><span class="tt">::testing::Expectation</span></p>
<p>Represents a mock function call expectation as created by <a class="el" href="#EXPECT_CALL">`EXPECT_CALL`</a>:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>::testing::Expectation;</div>
<div class="line">Expectation my_expectation = EXPECT_CALL(...);</div>
</div><!-- fragment --><p>Useful for specifying sequences of expectations; see the `After` clause of <span class="tt">EXPECT_CALL</span>.</p>
<h2 class="doxsection"><a class="anchor" id="ExpectationSet"></a>
ExpectationSet</h2>
<p><span class="tt">::testing::ExpectationSet</span></p>
<p>Represents a set of mock function call expectations.</p>
<p>Use the <span class="tt">+=</span> operator to add <a class="el" href="#Expectation">`Expectation`</a> objects to the set:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span>::testing::ExpectationSet;</div>
<div class="line">ExpectationSet my_expectations;</div>
<div class="line">my_expectations += EXPECT_CALL(...);</div>
</div><!-- fragment --><p>Useful for specifying sequences of expectations; see the `After` clause of <span class="tt">EXPECT_CALL</span>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Создано системой&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Globalizer</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Искать" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Навигация</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="_base_interval_8h_source.html">Исходный файл globalizer/method/include/BaseInterval.h</a></li>
<li class="toctree-l1"><a class="reference internal" href="_base_parameters_8h.html">Файл globalizer/parameters/include/BaseParameters.h</a></li>
<li class="toctree-l1"><a class="reference internal" href="class_solver.html">Класс Solver</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, TODO.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/html/md_third__party_2_problems_2third__party_2gtest_2docs_2reference_2mocking.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>